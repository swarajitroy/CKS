# Trivy

https://github.com/aquasecurity/trivy

A Simple and Comprehensive Vulnerability Scanner for Container Images, suitable for CI.

## A. Install Trivy
--

```
ubuntu@ip-172-31-22-219:~/trivy$ trivy
NAME:
   trivy - A simple and comprehensive vulnerability scanner for containers

USAGE:
   trivy command [command options] target

COMMANDS:
   image, i          scan an image
   filesystem, fs    scan local filesystem
   repository, repo  scan remote repository
   client, c         client mode
   server, s         server mode
   plugin, p         manage plugins
   help, h           Shows a list of commands or help for one command

OPTIONS:
   --quiet, -q        suppress progress bar and log output (default: false) [$TRIVY_QUIET]
   --debug, -d        debug mode (default: false) [$TRIVY_DEBUG]
   --cache-dir value  cache directory (default: "/home/ubuntu/.cache/trivy") [$TRIVY_CACHE_DIR]
   --help, -h         show help (default: false)
   --version, -v      print the version (default: false)


```

## B. Scan an Image
--

```
ubuntu@ip-172-31-22-219:~/trivy$ trivy image python:3.4-alpine
2021-06-27T16:33:48.176Z        INFO    Need to update DB
2021-06-27T16:33:48.176Z        INFO    Downloading DB...
22.23 MiB / 22.23 MiB [---------------------------------------------------------------------------------------------------------------------------------------------] 100.00% 7.37 MiB p/s 3s
2021-06-27T16:33:52.030Z        INFO    Detected OS: alpine
2021-06-27T16:33:52.030Z        INFO    Detecting Alpine vulnerabilities...
2021-06-27T16:33:52.031Z        INFO    Number of PL dependency files: 0
2021-06-27T16:33:52.031Z        WARN    This OS version is no longer supported by the distribution: alpine 3.9.2
2021-06-27T16:33:52.031Z        WARN    The vulnerability detection may be insufficient because security updates are not provided

python:3.4-alpine (alpine 3.9.2)
================================
Total: 37 (UNKNOWN: 0, LOW: 4, MEDIUM: 16, HIGH: 13, CRITICAL: 4)

+--------------+------------------+----------+-------------------+---------------+---------------------------------------+
|   LIBRARY    | VULNERABILITY ID | SEVERITY | INSTALLED VERSION | FIXED VERSION |                 TITLE                 |
+--------------+------------------+----------+-------------------+---------------+---------------------------------------+
| expat        | CVE-2018-20843   | HIGH     | 2.2.6-r0          | 2.2.7-r0      | expat: large number of                |
|              |                  |          |                   |               | colons in input makes parser          |
|              |                  |          |                   |               | consume high amount...                |
|              |                  |          |                   |               | -->avd.aquasec.com/nvd/cve-2018-20843 |
+              +------------------+          +                   +---------------+---------------------------------------+
|              | CVE-2019-15903   |          |                   | 2.2.7-r1      | expat: heap-based buffer              |
|              |                  |          |                   |               | over-read via crafted XML input       |
|              |                  |          |                   |               | -->avd.aquasec.com/nvd/cve-2019-15903 |
+--------------+------------------+----------+-------------------+---------------+---------------------------------------+
| libbz2       | CVE-2019-12900   | CRITICAL | 1.0.6-r6          | 1.0.6-r7      | bzip2: out-of-bounds write            |
|              |                  |          |                   |               | in function BZ2_decompress            |
|              |                  |          |                   |               | -->avd.aquasec.com/nvd/cve-2019-12900 |
+--------------+------------------+----------+-------------------+---------------+---------------------------------------+

```
